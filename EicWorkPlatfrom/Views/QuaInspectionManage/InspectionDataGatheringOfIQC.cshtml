<div class="panel panel-primary" ng-controller="iqcDataGatheringCtrl">
    <div class="panel-heading">
        <h6 class="panel-title"> 进料检验数据采集</h6>
    </div>
    <div class="panel-body">
        <div class="row">
            <div class="col-md-3">
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="输入工单号查询" ng-model="vmManager.orderId" ng-keydown="vmManager.searchMaterialIdKeyDown($event)">
                    <span class="input-group-btn">
                        <button class="btn btn-info" type="button" ng-click="vmManager.getMaterialDatas()"><span class="glyphicon glyphicon-search"></span></button>
                    </span>
                </div>
            </div>
            <div class="col-md-2 col-md-offset-5">
                <p>
                    <label>工单号:</label>
                    {{vmManager.currentMaterialIdItem.OrderID}}
                </p>
            </div>
            <div class="col-md-2">
                <p>
                    <label>数量:</label>
                    {{vmManager.currentMaterialIdItem.ProduceNumber}}
                </p>
            </div>
        </div>

        <div class="h-split"></div>

        <div class="row">
            <div class="col-md-3">
                <p>
                    <label>品名:</label>
                    {{vmManager.currentMaterialIdItem.ProductName}}
                </p>
            </div>
            <div class="col-md-4">
                <p>
                    <label>规格:</label>
                    {{vmManager.currentMaterialIdItem.ProductStandard}}
                </p>
            </div>
            <div class="col-md-3">
                <p>
                    <label>供应商:</label>
                    {{vmManager.currentMaterialIdItem.ProductSupplier}}
                </p>
            </div>
            <div class="col-md-2">
                <p>
                    <label>图号:</label>
                    {{vmManager.currentMaterialIdItem.ProductDrawID}}
                </p>
            </div>
        </div>
        <div class="h-split"></div>
        <div class="row clearfix">
            <div class="col-md-2">
                <div class="bs-callout bs-callout-info">
                    <p>
                        <i class="fa fa-list-ul">品号列表</i>
                    </p>
                </div>
                <div class="panel-group" ng-model="panels.activePanel" role="tablist" aria-multiselectable="true" bs-collapse>
                    <div class="panel panel-default" ng-repeat="item in vmManager.materialIdDatas">
                        <div class="panel-heading" role="tab" ng-click="vmManager.selectMaterialIdItem(item)">
                            <a bs-collapse-toggle style="cursor:pointer;color:#000">
                                {{item.ProductID}}
                            </a>
                        </div>
                        <div class="panel-collapse list-group " role="tabpanel" bs-collapse-target>
                            <a class="panel-body list-group-item" ng-repeat="item in vmManager.inspectionItemDatas"
                               ng-class="{'active':item===vmManager.currentInspectionItem}"
                               ng-click="vmManager.selectInspectionItem(item)">
                                {{item.InspectionItem}}
                                <i class="fa fa-check pull-right" ng-show="item.NeedFinishDataNumber===item.HaveFinishDataNumber" ng-class="{'badge-success':item.NeedFinishDataNumber===item.HaveFinishDataNumber}"></i>
                                <span class="pull-right" ng-class="{true: 'badge-info', false: 'badge-fail'}[item.InsptecitonItemIsFinished]">
                                    {{item.NeedFinishDataNumber}}/{{item.HaveFinishDataNumber}}
                                </span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-10">
                <div class="bs-callout bs-callout-info" style="min-height:500px;">
                    <div class="well">
                        <div class="row">
                            <div class="col-md-4">
                                <span>
                                    <label>检验项目:</label>
                                    {{vmManager.currentInspectionItem.InspectionItem}}
                                </span>
                            </div>
                            <div class="col-md-4">
                                <span>
                                    <label>规格值:</label>
                                    {{vmManager.currentInspectionItem.SizeMemo}}
                                </span>
                            </div>
                            <div class="col-md-4">
                                <span>
                                    <label>检验水平:</label>
                                    {{vmManager.currentInspectionItem.InspectionLevel}}
                                    <span ng-if="vmManager.currentInspectionItem.InspectionAQL">  AQL=</span>
                                    {{vmManager.currentInspectionItem.InspectionAQL}}
                                </span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <span>
                                    <label>抽样方案:</label>
                                    {{vmManager.currentInspectionItem.InspectionCount}}
                                    <span ng-if="vmManager.currentInspectionItem.InspectionCount">/</span>
                                    {{vmManager.currentInspectionItem.InspectionCount}}
                                    <span ng-if="vmManager.currentInspectionItem.RefuseCount">/</span>
                                    {{vmManager.currentInspectionItem.RefuseCount}}
                                </span>
                            </div>
                            <div class="col-md-4">
                                <span>
                                    <label>检验方法:</label>
                                    {{vmManager.currentInspectionItem.InspectionMode}}
                                </span>
                            </div>
                            <div class="col-md-4">
                                <span>
                                    <label>量具编号:</label>
                                    {{vmManager.iqcInspectionItemAllInfo.IqcInspectionItemConfig.EquipmentID}}
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="well">
                        <table class="table table-bordered table-condensed">
                            <thead>
                                <tr>
                                    <th ng-repeat="header in vmManager.inputDatas[0].cols">
                                        <label class="label label-info">Data{{header.colId}}</label>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="row in vmManager.inputDatas">
                                    <td ng-repeat="col in row.cols">
                                        <span ng-show="vmManager.currentInspectionItem.InspectionItemResult==='OK'">
                                            {{col.indata}}
                                        </span>
                                        <input ng-model="col.indata" style="text-align:center" ng-hide="vmManager.currentInspectionItem.InspectionItemResult==='OK'"
                                                ng-class="{'invalidInputBg':!col.result,'':col.result}" 
                                               title="规格上限:{{vmManager.currentInspectionItem.SizeUSL}} 规格下限:{{vmManager.currentInspectionItem.SizeLSL}}"
                                               focus-setter focus-if="col.focus" ng-keydown="vmManager.dataInputKeyDown(col,$event)" />
                                    </td>
                                </tr>
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td>
                                        <button class="btn btn-warning">保存数据</button>
                                    </td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="panel-footer">

    </div>
</div>