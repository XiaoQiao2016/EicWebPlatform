<div class="panel panel-default" ng-controller="itilProjectDevelopManageCtrl">
    <div bs-tabs bs-active-pane="vmManager.activeTab" cg-busy="{promise:promise}">
        <div bs-pane data-title="模块开发登记" data-name="initTab">
            <div class="row">
                <div class="col-md-8">
                    <div class="well">
                        <form role="form" name="formDevelopModuleManage" novalidate class="form-horizontal" onkeypress="if (event.keyCode === 13) return false;">
                            <div class="form-group">
                                <label for="devID" class="col-md-2 control-label">开发编号</label>
                                <div class="col-md-4">
                                    <input name="devID" class="form-control" ng-model="vm.DevID" required />
                                    <div class="error-messages" ng-messages="formDevelopModuleManage.devID.$error" ng-show="operate.showValidation">
                                        <small ng-message="required">开发编号不能为空</small>
                                    </div>
                                </div>
                                <label for="moduleName" class="col-md-2 control-label">模块名称</label>
                                <div class="col-md-4">
                                    <input name="moduleName" class="form-control" ng-model="vm.ModuleName" required />
                                    <div class="error-messages" ng-messages="formDevelopModuleManage.moduleName.$error" ng-show="operate.showValidation">
                                        <small ng-message="required">模块名称不能为空</small>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="mClassName" class="col-md-2 control-label">类名称</label>
                                <div class="col-md-4">
                                    <input name="mClassName" class="form-control" ng-model="vm.MClassName" required />
                                    <div class="error-messages" ng-messages="formDevelopModuleManage.mClassName.$error" ng-show="operate.showValidation">
                                        <small ng-message="required">类名称不能为空</small>
                                    </div>
                                </div>
                                <label for="mFunctionName" class="col-md-2 control-label">函数名称</label>
                                <div class="col-md-4">
                                    <input name="mFunctionName" class="form-control" ng-model="vm.MFunctionName" required />
                                    <div class="error-messages" ng-messages="formDevelopModuleManage.mFunctionName.$error" ng-show="operate.showValidation">
                                        <small ng-message="required">函数名称不能为空</small>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="functionDescription" class="col-md-2 control-label">功能描述</label>
                                <div class="col-md-10">
                                    <textarea name="functionDescription" rows="2" class="form-control" ng-model="vm.FunctionDescription" required />
                                    <div class="error-messages" ng-messages="formDevelopModuleManage.functionDescription.$error" ng-show="operate.showValidation">
                                        <small ng-message="required">功能描述不能为空</small>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="difficultyCoefficient" class="col-md-2 control-label">难度系数</label>
                                <div class="col-md-4">
                                    <input name="difficultyCoefficient" type="number" max="5" min="1" class="form-control" ng-model="vm.DifficultyCoefficient" required />
                                    <div class="error-messages" ng-messages="formDevelopModuleManage.difficultyCoefficient.$error" ng-show="operate.showValidation">
                                        <small ng-message="required">难度系数不能为空</small>
                                    </div>
                                </div>
                                <label for="devPriority" class="col-md-2 control-label">优先级</label>
                                <div class="col-md-4">
                                    <input name="devPriority" type="number" class="form-control" max="5" min="1" ng-model="vm.DevPriority" required />
                                    <div class="error-messages" ng-messages="formDevelopModuleManage.devPriority.$error" ng-show="operate.showValidation">
                                        <small ng-message="required">优先级不能为空</small>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="startDate" class="col-md-2 control-label">开始日期</label>
                                <div class="col-md-4">
                                    <input name="startDate" type="date" class="form-control" ng-model="vm.StartDate" format-date required />
                                    <div class="error-messages" ng-messages="formDevelopModuleManage.startDate.$error" ng-show="operate.showValidation">
                                        <small ng-message="required">开始日期不能为空</small>
                                    </div>
                                </div>
                                <label for="mExecutor" class="col-md-2 control-label">执行人</label>
                                <div class="col-md-4">
                                    <button type="button" class="btn btn-primary" ng-model="vm.Executor"
                                            data-html="1" data-multiple="0" data-animation="am-flip-x" data-placeholder="选择执行人"
                                            data-bs-options="cp.name as cp.text for cp in vmManager.executors track by $index" data-bs-select>
                                        <span class="caret"></span>
                                    </button>
                                    <input name="executor" class="form-control" ng-model="vm.Executor" ng-show="false" required />
                                    <div class="error-messages" ng-messages="formDevelopModuleManage.executor.$error" ng-show="operate.showValidation">
                                        <small ng-message="required">执行人不能为空</small>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="memo" class="col-md-2 control-label">备注</label>
                                <div class="col-md-10">
                                    <textarea name="memo" class="form-control" ng-model="vm.Memo" rows="2"/>
                                </div>
                            </div>

                            <hr />
                            <div class="alert alert-info">
                                <div class="row">
                                    <div class="col-md-2">
                                    </div>
                                    <div class="col-md-10">
                                        <button class="btn btn-primary" ng-click="operate.saveAll(formDevelopModuleManage.$valid)"><i class="fa fa-save"></i>保存</button>
                                        <button class="btn btn-default" ng-click="operate.refresh()"><i class="fa fa-undo"></i>取消</button>
                                        <span yl-operatemsg-board></span>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="col-md-4">
                    <ul class="list-group">
                        <li class="list-group-item active">
                            <div class="row">
                                <div class="col-md-4">
                                    <h4 class="list-title">
                                        <i class="fa fa-list"></i>
                                        <span>列表</span>
                                    </h4>
                                </div>
                                <div class="col-md-8">
                                    <div class="input-group">
                                        <input class="form-control" type="text" />
                                        <div class="input-group-addon">
                                            <i class="fa fa-search"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="list-group-item" ng-click="vmManager.selectDevelopModule(item)"
                            ng-repeat="item in vmManager.developModules track by $index">
                            {{$index+1}}.
                            类名：<span class="label label-default" style="cursor:pointer">{{item.MClassName}}</span>
                            函数<span class="label label-info">{{item.MFunctionName}}</span>
                        </li>
                        <li ng-if="vmManager.developModules.length>0">
                            <span class="btn btn-sm btn-success pull-right"><i class="fa fa-envelope-o"></i>发送通知</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div bs-pane data-title="项目进度管理" data-name="editTab">
            <div class="well">
                <div class="row">
                    <div class="col-md-6">
                        <form class="form-inline" novalidate>
                            <div class="form-group">
                                <label for="inputDate">开发进度:</label>
                                <button type="button" class="btn btn-default" ng-model="vmManager.selectedProgressStatuses"
                                        data-html="1" data-multiple="1" data-animation="am-flip-x" data-placeholder="选择当前进度..."
                                        data-bs-options="proStatus.value as proStatus.label for proStatus in vmManager.progressStatuses track by $index" data-bs-select>
                                       <span class="caret"></span>
                                </button>
                            </div>
                            <span class="btn btn-primary" ng-click="vmManager.getDevelopModules()"><i class="fa fa-search"></i>查询</span>
                            <span class="btn btn-warning" ng-click="vmManager.sendMail()"><i class="fa fa-mail-reply"></i>发送邮件</span>
                        </form>
                    </div>
                </div>
            </div>
            <div class="well" cg-busy="{promise:searchPromise}">
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr class="info">
                                <th>模块名称</th>
                                <th>类名称</th>
                                <th>函数名称</th>
                                <th>功能描述</th>
                                <th style="max-width:50px;">难度系数</th>
                                <th>开始日期</th>
                                <th>当前进度</th>
                                <th>执行人</th>
                                <th>变更日期</th>
                                <th>操作(<i class="fa fa-pencil-square-o"></i>)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="item in vmManager.datasets track by $index">
                                <td>{{item.ModuleName}}</td>
                                <td>{{item.MClassName}}</td>
                                <td>{{item.MFunctionName}}</td>
                                <td style="max-width:120px;">{{item.FunctionDescription}}</td>
                                <td>{{item.DifficultyCoefficient}}</td>
                                <td>{{item.StartDate}}</td>
                                <td>{{item.CurrentProgress}}</td>
                                <td>{{item.Executor}}</td>
                                <td>
                                    <span class="label label-primary">{{item.FinishDate}}</span>
                                </td>
                                <td>
                                    <button class="btn btn-xs btn-primary" ng-click="vmManager.changeProgressStatus(item)" title="变更进度">
                                        <i class="fa fa-edit"></i>进度
                                    </button>
                                    <button class="btn btn-xs btn-success" ng-click="operate.viewDetails(item)" title="查看明细">
                                        <i class="fa fa-eye"></i>明细
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div yl-pagination
                         data-datasource="vmManager.datasource"
                         data-dataset="vmManager.datasets">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="panel-footer">

    </div>
</div>