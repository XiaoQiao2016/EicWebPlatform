<div class="panel panel-primary" ng-controller="DailyProductionReportPT1Ctrl">
    <div class="panel-heading">
        <h6 class="panel-title">生产日报录入</h6>
    </div>
    <div class="panel-body">
        <div class="row">
            <div class="col-md-12">
                <form class="form-inline" novalidate>
                    <label>  部门:</label>
                    <button class="btn btn-success " ng-model="vmManagerPT.department" ng-change="vmManagerPT .changeDepartment()"
                            data-html="1" data-multiple="0" data-animation="am-flip-x" data-placeholder="选择部门"
                            data-bs-options="department.value as department.label for department in vmManager.departments track by $index" data-bs-select>
                        <span class="caret"></span>
                    </button>
                    <label>日期:</label>
                    <input name="queryDate" type="date" class="form-control" format-date ng-model="vm.InPutDate"
                           focus-setter data-ensure-user-exist style="width:200px;"
                           placeholder="日期" />
                    <button class="btn btn-success "
                            ng-click="vmManagerPT .loadDaialyDatas(vm.InPutDate)">
                        载入信息
                    </button>
                </form>
            </div>
        </div>
        <div class="well " cg-busy="{promise:searchPromise}" style="padding:10px;overflow-y:scroll;min-height:380px;max-height:480px;width:auto">
            <div class="table-responsive">
                <table class="table table-striped table-hover table-bordered" >
                    <thead>
                        <tr class="info">
                            <th>机台信息</th>
                            <th>工单信息</th>
                            <th>生产信息</th>
                            <th>人员信息</th>
                            <th>班别</th>
                            <th>操作(<i class="fa fa-pencil-square-o"></i>)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr id="tab" ng-repeat="item in  vmManagerPT.datasets track by $index">
                            @*机台*@
                            <td>
                                <span class="label label-primary" title="机台编号">{{item.MachineId}}</span>
                                <span class="label label-default" placeholder="机台名称">{{item.MachineName}}</span>
                                <span class="label label-success" placeholder="设置时数">设置时数:{{item.MachineSetProductionTime}}</span>
                                <div class="h-split"></div>
                                <span  ng-show="item.ProductName.length > 0" title="品名:">品名:{{item.ProductName}}</span><br />
                                <span ng-show="item.ProductSpec.length > 0"  title="规格:">规格:{{item.ProductSpec}}</span>
                            </td>
                            @*订单号*@
                            <td>
                                <input type="text" placeholder="订单号:" ng-model="item.OrderId"  ng-keypress="($event.which === 13)?vmManagerPT .getOrderIdDatas(item):0"/>
                                <span ng-show="item.MouldId.length>0" class="label label-primary" placeholder="模穴数:">模穴数:{{item.MouldHoleCount}}</span>
                                 <div class="h-split"></div>
                                <div ng-show="item.ProductName.length>0">
                                    <div class="input-group">
                                        <span class="input-group-addon">模具编号:</span>
                                        <div class="input-group-btn">
                                            <button type="button" class="btn btn-primary"
                                                    data-animation="am-flip-x"
                                                    bs-dropdown aria-haspopup="true" aria-expanded="false">
                                                <span class="fa fa-chevron-circle-down"></span>
                                            </button>
                                            <div class="dropdown-menu" role="menu">
                                                <ul class="list-group" style="overflow-y:auto; max-height:150px;">
                                                    <li class="list-group-item" style="cursor:pointer;" ng-click="vmManagerPT .selectmouldId(i,item)"
                                                        ng-repeat="i in item.mouldIdInfos " data-title="模具号：{{i.MouldId}}" data-bs-options>
                                                        <i class="fa fa-user"></i>
                                                        <span class="label label-primary">模具号：{{i.MouldId}}</span>|
                                                        <span>说明：{{i.MouldName}}</span>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                        <input type="text"  readonly ng-model="item.MouldId" />
                                    </div>
                                </div>
                               
                            </td>
                            @*生产量/不良数*@
                            <td>
                                <div class="form-group">
                                    <label>生产量:</label>
                                    <input type="number" placeholder="生产量:" ng-model="item.TodayProductionCount" ng-change="" /><br />
                                    <div class="h-split"></div>
                                    <label>不良数:</label>
                                    <input type="number" placeholder="不良数:" ng-model="item.TodayBadProductCount" ng-change="" />
                                </div>
                               
                            </td>
                            @*师傅/作业员*@
                            <td>
                                <div class="form-group">
                                 <div class="input-group">
                                            <span class="input-group-addon">师傅:</span>
                                            <input name="workerId" class="form-control" ng-keypress="($event.which === 13)?vmManagerPT .getWorkerInfo(item):0"
                                                   ng-model="vm.MasterWorkerId"
                                                   ng-keydown="focus.changeEnter($event,'workerIdFocus','processesIndexFocus')"
                                                   focus-if="focus.workerIdFocus" focus-setter
                                                   placeholder="输工号或姓名"
                                                   data-ensure-user-exist required />
                                            <div class="error-messages" ng-messages="formDailyProductionReport.workerId.$error" ng-if="formDailyProductionReport.workerId.$touched">
                                                <small ng-message="required">工号不能为空</small>
                                            </div>
                                            <div class="input-group-addon" ng-show="vmManagerPT .isSingle">
                                                <label class="label label-primary"> <i class="fa fa-user"></i> {{item.MasterName}}</label>
                                            </div>
                                            <div class="input-group-btn">
                                                <button type="button" class="btn btn-primary"
                                                        data-animation="am-flip-x"
                                                        bs-dropdown aria-haspopup="true" aria-expanded="false">
                                                    <span class="fa fa-chevron-circle-down"></span>
                                                </button>
                                                <div class="dropdown-menu" role="menu">
                                                    <ul class="list-group">
                                                        <li class="list-group-item" style="cursor:pointer" ng-click="vmManagerPT .selectWorker(worker,item,1)"
                                                            ng-repeat="worker in  vmManagerPT.mentMasterDatas track by $index" data-title="岗位：{{worker.Post}}" data-bs-tooltip>
                                                            <i class="fa fa-user"></i>
                                                            <span class="label label-primary">工号:{{worker.WorkerId}}</span>|
                                                            <span>姓名:{{worker.Name}}</span>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                </div>
                                <div class="h-split"></div>
                                <div class="form-group">
                                    <div class="input-group">
                                        <span class="input-group-addon">看机人:</span>
                                        <input name="workerId" class="form-control" ng-keypress="($event.which === 13)?vmManagerPT .getWorkerInfo(item):0"
                                               ng-model="item.WorkerId"
                                               ng-keydown="focus.changeEnter($event,'workerIdFocus','processesIndexFocus')"
                                               focus-if="focus.workerIdFocus" focus-setter
                                               placeholder="输工号或姓名"
                                               data-ensure-user-exist required />
                                        <div class="error-messages" ng-messages="formDailyProductionReport.workerId.$error" ng-if="formDailyProductionReport.workerId.$touched">
                                            <small ng-message="required">工号不能为空</small>
                                        </div>
                                        <div class="input-group-addon" ng-show="vmManagerPT .isSingle">
                                            <label class="label label-primary"> <i class="fa fa-user"></i> {{item.WorkerName}}</label>
                                        </div>
                                        <div class="input-group-btn">
                                            <button type="button" class="btn btn-primary"
                                                    data-animation="am-flip-x"
                                                    bs-dropdown aria-haspopup="true" aria-expanded="false">
                                                <span class="fa fa-chevron-circle-down"></span>
                                            </button>
                                            <div class="dropdown-menu" role="menu">
                                                <ul class="list-group">
                                                    <li class="list-group-item" style="cursor:pointer" ng-click="vmManagerPT .selectWorker(worker,item,2)"
                                                        ng-repeat="worker in vmManagerPT .searchedWorkers track by $index" data-title="岗位：{{worker.Post}}" data-bs-tooltip>
                                                        <i class="fa fa-user"></i>
                                                        <span class="label label-primary">工号：{{worker.WorkerId}}</span>|
                                                        <span>姓名：{{worker.Name}}</span>|
                                                        <span>部门：{{worker.Department}}</span>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <label>时数:</label>
                                    <input type="number" placeholder="看机时数:" ng-model="item.WorkerProductionTime" ng-change="" />
                                </div>
                            </td>
                            @*班别*@
                            <td>
                                <button  class="btn btn-success"  ng-if="item.ClassType=='白班'"
                                        ng-click="vmManagerPT.classTypeChange(item)">{{item.ClassType}}
                                </button> 
                                <button class="btn btn-danger" ng-if="item.ClassType=='晚班'"
                                 ng-click="vmManagerPT .classTypeChange(item)">
                                   {{item.ClassType}}
                                    </button>
                            </td>
                            @*插入/删除*@
                            <td class="text-center">
                                @*工具按钮*@
                                <button type="button" class="btn btn-xs btn-success"
                                        data-animation="am-flip-x" data-placement="right"
                                        bs-dropdown aria-haspopup="true" aria-expanded="false" style="height :auto;width :auto">
                                    <span class="fa fa-indent" title="新增"></span>
                                </button>
                                <div class="dropdown-menu" role="menu">
                                    <ul class="nav nav-pills" role="tablist">
                                        <li role="presentation">
                                            <a href="#" ng-click="vmManagerPT .insertNewRow(this,item)" title="插入行"><i class="fa fa-pencil"></i>插入</a>
                                        </li>
                                        <li role="presentation">
                                            <a href="#" ng-click="vmManagerPT .removeRow(this,item)" title="删除此行"><i class="fa fa-remove"></i>删除</a>
                                        </li>
                                    </ul>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div yl-pagination  data-datasource="vmManager.datasource"
                     data-dataset="vmManager.datasets">
                </div>
            </div>
        </div>
        <div class="row">
            <button class="btn btn-sm btn-warning" title="批量保存" ng-click="operate.saveAllDatas()"><i class="fa fa-save"></i>批量保存</button>
        </div>
    </div>
    <div class="panel-footer"></div>
</div>

