<div class="panel panel-primary" ng-controller="dReportInputCtrl">
    <div class="panel-heading">
        <h6 class="panel-title">生产日报录入</h6>
    </div>
    <div class="panel-body">
        <div cg-busy="{promise:promise}">
            <button class="btn btn-sm btn-warning" title="载入模板" ng-click="vmManager.getReportInputDataTemplate()"><i class="fa fa-download"></i>载入模板</button>
            <button type="button" class="btn btn-sm btn-default" ng-model="vmManager.inputMode"
                    data-html="1" data-multiple="0" ng-change="vmManager.selectInputMode()"
                    data-animation="am-flip-x" data-placeholder="录入模式"
                    bs-options="item.id as item.text for item in vmManager.inputModes" bs-select>
                <span class="caret"></span>
            </button>
             部门<label class="label label-default">{{vmManager.department}}</label>
            <button class="btn btn-sm btn-default"
                    data-title="选择部门名称"
                    data-template-url="@Url.Action("TreeSelectTpl", "CommonTpl")"
                    data-animation="am-flip-x" data-auto-close="1"
                    data-bs-popover>
                <i class="fa fa-sitemap"></i>
            </button>
            <label>录入日期</label>
            <input type="date" ng-model="vmManager.InputDate"/>
            <span>
               
                <button class="btn btn-sm btn-primary" title="新增" ng-click="vmManager.showDReportInputView()"><i class="fa fa-pencil"></i>新增</button>
                <button class="btn btn-sm btn-success" title="保存" ng-click="operate.save()"><i class="fa fa-save"></i>保存</button>
                <span class="pull-right">
                    <button class="btn btn-sm btn-primary" title="日报预览看板" ng-click="vmManager.showDReportPreviewView()"><i class="fa fa-table"></i>日报预览</button>
                    <button class="btn btn-sm btn-default" title="工序汇总看板" ng-click="vmManager.showProFlowView()"><i class="fa fa-th-large"></i>工序汇总</button>
                    <button class="btn btn-sm btn-default" title="人员汇总看板" ng-click="vmManager.showPersonView()"><i class="fa fa-th-list"></i>人员汇总</button>
                    <button class="btn btn-sm btn-default" title="工单汇总看板" ng-click="vmManager.showOrderIdView()"><i class="fa fa-list-ol"></i>工单汇总</button>
                </span>
            </span>
            <div class="h-split"></div>
        </div>
        <div class="bs-callout bs-callout-info" style="min-height:465px;" id="editWindow">
            <div class="table-responsive">
                <table class="table table-bordered table-condensed table-hover">
                    <thead>
                        <tr>
                            <th class="text-center" colspan="{{tbl.orderIdColSpan}}">工单信息</th>

                            <th class="text-center" colspan="{{tbl.proFlowColSpan}}">机台/工艺</th>

                            <th class="text-center" colspan="{{tbl.workerColSpan}}">人员</th>

                            <th style="width:80px;" class="text-center info"><i class="fa fa-flag"></i></th>

                            <th class="text-center" colspan="{{tbl.productColSpan}}">产量</th>

                            <th class="text-center" colspan="{{tbl.workHoursColSpan}}">工时</th>

                            <th class="text-center danger">操作(<i class="fa fa-pencil-square-o"></i>)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="width:100px;" class="text-center"><span>工单号</span></td>
                            <td style="width:auto" class="text-center" ng-show="tbl.colVisible"><span>品名</span></td>
                            <td style="width:auto" class="text-center" ng-show="tbl.colVisible"><span>规格</span></td>

                            <td style="width:100px;" class="text-center">
                                <span>机台*工艺</span>
                            </td>
                            <td style="width:auto" class="text-center" ng-show="tbl.colVisible">
                                <span>标准工时</span>
                            </td>

                            <td style="width:80px;" class="text-center"><span>作业员</span></td>
                            <td style="width:80px;" class="text-center"><span>师傅</span></td>
                            <td ng-show="tbl.colVisible"><span>班别</span></td>


                            <td style="width:80px;" class="text-center"></td>


                            <td><span>产量</span></td>
                            <td ng-show="tbl.colVisible"><span>调机不良数</span></td>
                            <td><span>生产不良数</span></td>
                            <td ng-show="tbl.colVisible"><span>校验不良数</span></td>

                            <td ng-show="tbl.colVisible"><span>设置时数</span></td>
                            <td><span>投入工时</span></td>
                            <td><span>出勤时数</span></td>
                            <td><span>生产时数</span></td>
                            <td><span>非生产时数</span></td>
                        </tr>

                        <tr ng-repeat="item in vmManager.editDatas track by $index" ng-dblclick="vmManager.editRow(item)">
                            @*工单信息*@
                            <td style="width:100px;">
                                <span ng-hide="item.editting">{{item.OrderId}}</span>
                                <input ng-model="vm.OrderId" focus-if="focus.orderIdFocus" focus-setter style="width:100px;"
                                       ng-keydown="vmManager.getWorkOrderInfo($event)" placeholder="工单单号" ng-show="item.editting" />
                            </td>

                            <td style="width:auto" class="text-center" ng-show="tbl.colVisible">{{ProductName}}</td>
                            <td style="width:auto" class="text-center" ng-show="tbl.colVisible">{{ProductSpecification}}</td>

                            @*工艺、机台*@
                            <td style="width:100px;">
                                <span ng-hide="item.editting">{{item.ProductFlowID}}</span>
                                <input ng-model="vm.ProductFlowID" focus-if="focus.productFlowFocus" focus-setter style="width:100px;"
                                       ng-keydown="vmManager.getProductFlowInfo($event)" placeholder="编号或名称" ng-show="item.editting" />
                            </td>
                            <td style="width:auto" class="text-center" ng-show="tbl.colVisible">{{StandardHours}}</td>


                            <td>
                                <span ng-hide="item.editting">{{item.UserWorkerId}}</span>
                                <input ng-model="vm.UserWorkerId" ng-keydown="vmManager.getWorkerInfo($event)"
                                       focus-if="focus.workerIdFocus" focus-setter style="width:80px;"
                                       placeholder="工号或姓名" ng-show="item.editting" />
                            </td>
                            <td>
                                <span ng-hide="item.editting">{{item.MasterWorkerId}}</span>
                                <input ng-model="vm.MasterWorkerId" ng-keydown="vmManager.getWorkerInfo($event)"
                                       focus-if="focus.workerIdFocus" focus-setter style="width:80px;"
                                       placeholder="工号或姓名" ng-show="item.editting" />
                            </td>
                            <td ng-show="tbl.colVisible" style="width:auto" class="text-center">{{item.ClassType}}</td>

                            <td style="width:80px;" class="text-center">
                                <span class="btn btn-xs btn-primary" ng-show="item.editting" ng-click="vmManager.editOver()" title="结束编辑"><i class="fa fa-sign-out"></i></span>
                                <span class="btn btn-xs btn-danger" ng-show="item.editting" ng-click="vmManager.removeRow()" title="删除此行"><i class="fa fa-remove"></i></span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        @*<div pageslide ps-open="vmManager.dReportInputDisplay" ps-side="right" ps-size="{{vmManager.inputViewSize}}" p ps-speed="0.15" ps-container='editWindow'>
            <div style="padding:10px;overflow-y:auto">
                <form role="form" name="formDailyReports" novalidate class="form-horizontal" onkeypress="if (event.keyCode === 13) return false;">
                    <fieldset>
                        <legend>
                        工单信息
                            <span class="label label-default">{{vm.OrderId}}</span>
                            <span class="label label-info">{{vm.ProductName}}</span>
                            <span class="label label-success">{{vm.ProductSpecification}}</span>
                        </legend>
                        <div class="form-group">
                            <label for="orderId" class="col-md-3 control-label">工单单号</label>
                            <div class="col-md-4">
                                <input name="orderId" class="form-control" ng-model="vm.OrderId" focus-if="focus.orderIdFocus" focus-setter
                                       ng-keypress="vmManager.getWorkOrderInfo($event)"
                                       placeholder="请输入工单单号" required />
                                <div class="error-messages" ng-messages="formDailyReports.orderId.$error" ng-show="operate.showValidation">
                                    <small ng-message="required">工单单号不能为空</small>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                    <fieldset>
                        <legend>
                        人员信息
                            <span class="label label-default">{{vm.Department}}</span>
                            <span class="label label-info">{{vm.UserWorkerId}}</span>
                            <span class="label label-success">{{vm.UserName}}</span>
                        </legend>
                        <div class="form-group">
                            <label for="userWorkerId" class="col-md-3 control-label">员工工号</label>
                            <div class="col-md-4">
                                <div class="input-group">
                                    <input name="userWorkerId" class="form-control" ng-model="vm.UserWorkerId" ng-keypress="vmManager.getWorkerInfo($event)"
                                           focus-if="focus.workerIdFocus" focus-setter required data-ensure-user-exist placeholder="输入作业工号或者姓名" />
                                    <div class="error-messages" ng-messages="formDailyReports.userWorkerId.$error" ng-show="operate.showValidation">
                                        <small ng-message="required">员工工号不能为空</small>
                                    </div>
                                    <div class="input-group-addon" ng-show="vmManager.isSingle">
                                        <label class="label label-primary"> <i class="fa fa-user"></i> {{vm.WorkerName}}</label>
                                    </div>
                                    <div class="input-group-btn" ng-hide="vmManager.isSingle">
                                        <button type="button" class="btn btn-primary"
                                                data-animation="am-flip-x"
                                                bs-dropdown aria-haspopup="true" aria-expanded="false">
                                            <span class="fa fa-chevron-circle-down"></span>
                                        </button>
                                        <div class="dropdown-menu" role="menu">
                                            <ul class="list-group">
                                                <li class="list-group-item" style="cursor:pointer" ng-click="vmManager.selectWorker(worker)"
                                                    ng-repeat="worker in vmManager.searchedWorkers track by $index" data-title="岗位：{{worker.Post}}" data-bs-tooltip>
                                                    <i class="fa fa-user"></i>
                                                    <span class="label label-primary">工号：{{worker.WorkerId}}</span>|
                                                    <span>姓名：{{worker.Name}}</span>|
                                                    <span>部门：{{worker.Department}}</span>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                    <fieldset>
                        <legend>工艺信息</legend>
                        <div class="form-group">
                            <div class="form-group">
                                <label for="productFlowID" class="col-md-3 control-label">工序编号(或名称)</label>
                                <div class="col-md-4">
                                    <div class="input-group">
                                        <input name="productFlowID" class="form-control" ng-model="vm.ProductFlowID" focus-if="focus.productFlowFocus" focus-setter
                                               ng-keypress="vmManager.getProductFlowInfo($event)" required placeholder="输入工序编号或者工序名称" />
                                        <div class="error-messages" ng-messages="formDailyReports.productFlowID.$error" ng-show="operate.showValidation">
                                            <small ng-message="required">工序编号不能为空</small>
                                        </div>
                                        <div class="input-group-btn">
                                            <button type="button" class="btn btn-primary"
                                                    data-animation="am-flip-x"
                                                    bs-dropdown aria-haspopup="true" aria-expanded="false">
                                                <span class="fa fa-chevron-circle-down"></span>
                                            </button>
                                            <div class="dropdown-menu" role="menu">
                                                <ul class="list-group">
                                                    <li class="list-group-item" style="cursor:pointer" ng-click="vmManager.selectProductFlow(pflow)"
                                                        ng-repeat="pflow in vmManager.productFlows track by $index" data-title="岗位：{{w.Post}}" data-bs-tooltip>
                                                        <i class="fa fa-user"></i>
                                                        <span class="label label-primary">工号：{{worker.WorkerId}}</span>|
                                                        <span>姓名：{{worker.Name}}</span>|
                                                        <span>部门：{{worker.Department}}</span>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                    <hr />
                    <div class="alert alert-info">
                        <div class="row">
                            <div class="col-md-3">
                            </div>
                            <div class="col-md-9">
                                <button class="btn btn-primary" focus-if="focus.saveCmdFocus" focus-setter ng-keypress="vmManager.addRecord(formDailyReports.$valid)"
                                        ng-click="operate.add(formDailyReports.$valid)">
                                    <i class="fa fa-save"></i>增加
                                </button>
                                <button class="btn btn-default" ng-click="operate.refresh()"><i class="fa fa-undo"></i>取消</button>
                                <span yl-operatemsg-board></span>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>*@

        @*<div pageslide ps-open="vmManager.dReportInputDisplay" ps-side="right" ps-size="{{vmManager.inputViewSize}}" p ps-speed="0.15" ps-container='editWindow'>
            <div style="padding:10px;overflow-y:auto">
                <form role="form" name="formDailyReports" novalidate class="form-horizontal" onkeypress="if (event.keyCode === 13) return false;">
                    <fieldset>
                        <div class="form-group">
                            <label for="qty" class="col-md-2 control-label">总产量</label>
                            <div class="col-md-4">
                                <input name="qty" class="form-control" ng-model="vm.Qty" required />
                                <div class="error-messages" ng-messages="formDailyReports.qty.$error" ng-show="operate.showValidation">
                                    <small ng-message="required">总产量不能为空</small>
                                </div>
                            </div>
                            <label for="qtyGood" class="col-md-2 control-label">良品数量</label>
                            <div class="col-md-4">
                                <input name="qtyGood" class="form-control" ng-model="vm.QtyGood" required />
                                <div class="error-messages" ng-messages="formDailyReports.qtyGood.$error" ng-show="operate.showValidation">
                                    <small ng-message="required">良品数量不能为空</small>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="qtyBad" class="col-md-2 control-label">不良品数量</label>
                            <div class="col-md-4">
                                <input name="qtyBad" class="form-control" ng-model="vm.QtyBad" required />
                                <div class="error-messages" ng-messages="formDailyReports.qtyBad.$error" ng-show="operate.showValidation">
                                    <small ng-message="required">不良品数量不能为空</small>
                                </div>
                            </div>
                            <label for="failureRate" class="col-md-2 control-label">不良率</label>
                            <div class="col-md-4">
                                <input name="failureRate" class="form-control" ng-model="vm.FailureRate" required />
                                <div class="error-messages" ng-messages="formDailyReports.failureRate.$error" ng-show="operate.showValidation">
                                    <small ng-message="required">不良率不能为空</small>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="inputHours" class="col-md-2 control-label">投入时数</label>
                            <div class="col-md-4">
                                <input name="inputHours" class="form-control" ng-model="vm.InputHours" required />
                                <div class="error-messages" ng-messages="formDailyReports.inputHours.$error" ng-show="operate.showValidation">
                                    <small ng-message="required">投入时数不能为空</small>
                                </div>
                            </div>
                            <label for="attendanceHours" class="col-md-2 control-label">出勤时数</label>
                            <div class="col-md-4">
                                <input name="attendanceHours" class="form-control" ng-model="vm.AttendanceHours" required />
                                <div class="error-messages" ng-messages="formDailyReports.attendanceHours.$error" ng-show="operate.showValidation">
                                    <small ng-message="required">出勤时数不能为空</small>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="nonProductionHours" class="col-md-2 control-label">非生产时数</label>
                            <div class="col-md-4">
                                <input name="nonProductionHours" class="form-control" ng-model="vm.NonProductionHours" required />
                                <div class="error-messages" ng-messages="formDailyReports.nonProductionHours.$error" ng-show="operate.showValidation">
                                    <small ng-message="required">非生产时数不能为空</small>
                                </div>
                            </div>
                            <label for="receiveHours" class="col-md-2 control-label">得到工时</label>
                            <div class="col-md-4">
                                <input name="receiveHours" class="form-control" ng-model="vm.ReceiveHours" required />
                                <div class="error-messages" ng-messages="formDailyReports.receiveHours.$error" ng-show="operate.showValidation">
                                    <small ng-message="required">得到工时不能为空</small>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="manHours" class="col-md-2 control-label">人工工时</label>
                            <div class="col-md-4">
                                <input name="manHours" class="form-control" ng-model="vm.ManHours" required />
                                <div class="error-messages" ng-messages="formDailyReports.manHours.$error" ng-show="operate.showValidation">
                                    <small ng-message="required">人工工时不能为空</small>
                                </div>
                            </div>
                            <label for="productionEfficiency" class="col-md-2 control-label">生产效率</label>
                            <div class="col-md-4">
                                <input name="productionEfficiency" class="form-control" ng-model="vm.ProductionEfficiency" required />
                                <div class="error-messages" ng-messages="formDailyReports.productionEfficiency.$error" ng-show="operate.showValidation">
                                    <small ng-message="required">生产效率不能为空</small>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="operationEfficiency" class="col-md-2 control-label">作业效率</label>
                            <div class="col-md-4">
                                <input name="operationEfficiency" class="form-control" ng-model="vm.OperationEfficiency" required />
                                <div class="error-messages" ng-messages="formDailyReports.operationEfficiency.$error" ng-show="operate.showValidation">
                                    <small ng-message="required">作业效率不能为空</small>
                                </div>
                            </div>
                        </div>

                    </fieldset>
                    <hr />
                    <div class="alert alert-info">
                        <div class="row">
                            <div class="col-md-2">
                            </div>
                            <div class="col-md-10">
                                <button class="btn btn-primary" ng-click="operate.saveAll(formDailyReports.$valid)"><i class="fa fa-save"></i>保存</button>
                                <button class="btn btn-default" ng-click="operate.refresh()"><i class="fa fa-undo"></i>取消</button>
                                <span yl-operatemsg-board></span>
                            </div>
                        </div>
                    </div>
                </form>

            </div>
        </div>*@

        <div pageslide ps-open="vmManager.dReportPreviewDisplay" ps-side="bottom" ps-size="{{vmManager.boardViewSize}}" p ps-speed="0.25" ps-container='editWindow'>
            <div style="padding:10px;overflow-y:auto">

            </div>
        </div>
        <div pageslide ps-open="vmManager.proFlowBoardDisplay" ps-side="bottom" ps-size="{{vmManager.boardViewSize}}" p ps-speed="0.25" ps-container='editWindow'>
            <div style="padding:10px;overflow-y:auto">

            </div>
        </div>
        <div pageslide ps-open="vmManager.personBoardDisplay" ps-side="bottom" ps-size="{{vmManager.boardViewSize}}" p ps-speed="0.25" ps-container='editWindow'>
            <div style="padding:10px;overflow-y:auto">

            </div>
        </div>
        <div pageslide ps-open="vmManager.orderIdBoardDisplay" ps-side="bottom" ps-size="{{vmManager.boardViewSize}}" p ps-speed="0.25" ps-container='editWindow'>
            <div style="padding:10px;overflow-y:auto">

            </div>
        </div>
    </div>

    <div class="panel-footer">

    </div>
</div>