<div class="panel panel-default" ng-controller="astArchiveInputCtrl">
    <div bs-tabs bs-active-pane="vmManager.activeTab" cg-busy="{promise:promise}">
            <div bs-pane data-title="设备档案登记" data-name="initTab">
                <div class="row">
                    <div class="col-md-8">
                        <div class="well">
                            <form role="form" name="formEquipment" novalidate class="form-horizontal" onkeypress="if (event.keyCode === 13) return false;">
                                <fieldset>
                                    <legend>基本信息</legend>
                                    <div class="form-group">
                                        <label for="equipmentType" class="col-md-2 control-label">设备类别</label>
                                        <div class="col-md-4">
                                            <button type="button" class="btn btn-default" ng-model="vm.EquipmentType" data-html="1" data-multiple="0"
                                                    data-animation="am-flip-x" data-placeholder="量测设备" ng-change="vmManager.getAstId()"
                                                    bs-options="item.text as item.text for item in vmManager.equTypes" bs-select>
                                                <span class="caret"></span>
                                            </button>
                                            <input name="equipmentType" class="form-control" ng-model="vm.EquipmentType" ng-show="false" required />
                                            <div class="error-messages" ng-messages="formEquipment.equipmentType.$error" ng-show="operate.showValidation">
                                                <small ng-message="required">设备类别不能为空</small>
                                            </div>
                                        </div>

                                        <label for="assetType" class="col-md-2 control-label">资产类别</label>
                                        <div class="col-md-4">
                                            <button type="button" class="btn btn-default" ng-model="vm.AssetType" data-html="1" data-multiple="0"
                                                    data-animation="am-flip-x" data-placeholder="低质易耗品" ng-change="vmManager.getAstId()"
                                                    bs-options="item.text as item.text for item in vmManager.assetTypes" bs-select>
                                                <span class="caret"></span>
                                            </button>
                                            <input name="assetType" class="form-control" ng-model="vm.AssetType" ng-show="false" required />
                                            <div class="error-messages" ng-messages="formEquipment.assetType.$error" ng-show="operate.showValidation">
                                                <small ng-message="required">资产类别不能为空</small>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="taxType" class="col-md-2 control-label">税务类别</label>
                                        <div class="col-md-4">
                                            <button type="button" class="btn btn-default" ng-model="vm.TaxType" ng-change="vmManager.getAstId()" data-html="1" data-multiple="0"
                                                    data-animation="am-flip-x" data-placeholder="选择税务类别"
                                                    bs-options="item.text as item.text for item in vmManager.taxTypes" bs-select>
                                                <span class="caret"></span>
                                            </button>
                                            <input name="taxType" class="form-control" ng-model="vm.TaxType" ng-show="false" required />
                                            <div class="error-messages" ng-messages="formEquipment.taxType.$error" ng-show="operate.showValidation">
                                                <small ng-message="required">税务类别不能为空</small>
                                            </div>
                                        </div>
                                        <label for="assetNumber" class="col-md-2 control-label">设备编号</label>
                                        <div class="col-md-4">
                                            <input name="assetNumber" class="form-control" ng-model="vm.AssetNumber" readonly required />
                                            <div class="error-messages" ng-messages="formEquipment.assetNumber.$error" ng-show="operate.showValidation">
                                                <small ng-message="required">设备编号不能为空</small>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="equipmentName" class="col-md-2 control-label">设备名称</label>
                                        <div class="col-md-4">
                                            <input name="equipmentName" class="form-control" ng-model="vm.EquipmentName" required />
                                            <div class="error-messages" ng-messages="formEquipment.equipmentName.$error" ng-show="operate.showValidation">
                                                <small ng-message="required">设备名称不能为空</small>
                                            </div>
                                        </div>
                                        <label for="equipmentSpec" class="col-md-2 control-label">规格型号</label>
                                        <div class="col-md-4">
                                            <input name="equipmentSpec" class="form-control" ng-model="vm.EquipmentSpec" required />
                                            <div class="error-messages" ng-messages="formEquipment.equipmentSpec.$error" ng-show="operate.showValidation">
                                                <small ng-message="required">规格型号不能为空</small>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="manufacturingNumber" class="col-md-2 control-label">制造编号</label>
                                        <div class="col-md-4">
                                            <input name="manufacturingNumber" class="form-control" ng-model="vm.ManufacturingNumber" required />
                                            <div class="error-messages" ng-messages="formEquipment.manufacturingNumber.$error" ng-show="operate.showValidation">
                                                <small ng-message="required">制造编号不能为空</small>
                                            </div>
                                        </div>
                                        <label for="unit" class="col-md-2 control-label">单位</label>
                                        <div class="col-md-4">
                                            <button type="button" class="btn btn-default" ng-model="vm.Unit" data-html="1" data-multiple="0"
                                                    data-animation="am-flip-x" data-placeholder="台"
                                                    bs-options="item.text as item.text for item in vmManager.equUnits" bs-select>
                                                <span class="caret"></span>
                                            </button>
                                            <input name="unit" class="form-control" ng-model="vm.Unit" ng-show="false" readonly required />
                                            <div class="error-messages" ng-messages="formEquipment.unit.$error" ng-show="operate.showValidation">
                                                <small ng-message="required">单位不能为空</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group" ng-show="vm.TaxType==='保税'">
                                        <label for="freeOrderNumber" class="col-md-2 control-label">免单号</label>
                                        <div class="col-md-4">
                                            <input name="freeOrderNumber" class="form-control" ng-model="vm.FreeOrderNumber" />
                                        </div>
                                        <label for="declarationNumber" class="col-md-2 control-label">报关单号</label>
                                        <div class="col-md-4">
                                            <input name="declarationNumber" class="form-control" ng-model="vm.DeclarationNumber" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="deliveryDate" class="col-md-2 control-label">购入日期</label>
                                        <div class="col-md-4">
                                            <input name="deliveryDate" type="date" class="form-control" ng-model="vm.DeliveryDate" required />
                                            <div class="error-messages" ng-messages="formEquipment.deliveryDate.$error" ng-show="operate.showValidation">
                                                <small ng-message="required">购入日期不能为空</small>
                                            </div>
                                        </div>
                                        <label for="addMode" class="col-md-2 control-label">增加方式</label>
                                        <div class="col-md-4">
                                            <button type="button" class="btn btn-default" ng-model="vm.AddMode" data-html="1" data-multiple="0"
                                                    data-animation="am-flip-x" data-placeholder="外购"
                                                    bs-options="item.text as item.text for item in vmManager.addModes" bs-select>
                                                <span class="caret"></span>
                                            </button>
                                            <input name="addMode" class="form-control" ng-model="vm.AddMode" ng-show="false" required />
                                            <div class="error-messages" ng-messages="formEquipment.addMode.$error" ng-show="operate.showValidation">
                                                <small ng-message="required">增加方式不能为空</small>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="serviceLife" class="col-md-2 control-label">使用寿命</label>
                                        <div class="col-md-4">
                                            <div class="input-group">
                                                <input name="serviceLife" type="number" class="form-control" ng-model="vm.ServiceLife" required />
                                                <div class="error-messages" ng-messages="formEquipment.serviceLife.$error" ng-show="operate.showValidation">
                                                    <small ng-message="required">使用寿命不能为空</small>
                                                </div>
                                                <div class="input-group-addon">
                                                    <label class="label label-primary">年</label>
                                                </div>
                                            </div>
                                        </div>
                                        <label for="manufacturer" class="col-md-2 control-label">生产厂家</label>
                                        <div class="col-md-4">
                                            <input name="manufacturer" class="form-control" ng-model="vm.Manufacturer" required />
                                            <div class="error-messages" ng-messages="formEquipment.manufacturer.$error" ng-show="operate.showValidation">
                                                <small ng-message="required">生产厂家不能为空</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="safekeepUser" class="col-md-2 control-label">保管人</label>
                                        <div class="col-md-4">
                                            <div class="input-group">
                                                <input name="safekeepUser" class="form-control" data-ensure-user-exist
                                                       ng-change="vmManager.getWorkerInfo()"
                                                       placeholder="输工号或姓名" ng-model="vm.SafekeepUser" required />
                                                <div class="error-messages" ng-messages="formEquipment.safekeepUser.$error" ng-if="formEquipment.safekeepUser.$touched">
                                                    <small ng-message="checkingUserExist">该用户名不存在...</small>
                                                </div>
                                                <div class="error-messages" ng-messages="formEquipment.safekeepUser.$error" ng-show="operate.showValidation">
                                                    <small ng-message="required">保管人不能为空</small>
                                                </div>
                                                <div class="input-group-addon" ng-show="vmManager.isSingle">
                                                    <label class="label label-primary"> <i class="fa fa-user"></i> {{vm.SafekeepUser}}</label>
                                                </div>
                                                <div class="input-group-btn" ng-hide="vmManager.isSingle">
                                                    <button type="button" class="btn btn-primary"
                                                            data-animation="am-flip-x"
                                                            bs-dropdown aria-haspopup="true" aria-expanded="false">
                                                        <span class="fa fa-chevron-circle-down"></span>
                                                    </button>
                                                    <div class="dropdown-menu" role="menu">
                                                        <ul class="list-group">
                                                            <li class="list-group-item" style="cursor:pointer" ng-click="vmManager.selectWorker(worker)"
                                                                ng-repeat="worker in vmManager.searchedWorkers track by $index" data-title="岗位：{{worker.Post}}" data-bs-tooltip>
                                                                <i class="fa fa-user"></i>
                                                                <span class="label label-primary">工号：{{worker.WorkerId}}</span>|
                                                                <span>姓名：{{worker.Name}}</span>|
                                                                <span>部门：{{worker.Department}}</span>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <label for="safekeepDepartment" class="col-md-2 control-label">保管单位</label>
                                        <div class="col-md-4">
                                            <div class="input-group">
                                                <input name="safekeepDepartment" class="form-control" ng-model="vm.SafekeepDepartment" readonly required />
                                                <div class="error-messages" ng-messages="formEquipment.safekeepDepartment.$error" ng-show="operate.showValidation">
                                                    <small ng-message="required">保管单位不能为空</small>
                                                </div>
                                                <div class="input-group-btn">
                                                    <button class="btn btn-primary" style="margin-bottom:6px;" id="departmentPopover"
                                                            data-title="选择部门名称"
                                                            data-template-url="@Url.Action("TreeSelectTpl", "CommonTpl")"
                                                            data-animation="am-flip-x" data-auto-close="1"
                                                            data-keyboard="false"
                                                            data-bs-popover>
                                                        <i class="fa fa-sitemap"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="installationlocation" class="col-md-2 control-label">安装位置</label>
                                        <div class="col-md-4">
                                            <input name="installationlocation" class="form-control" ng-model="vm.Installationlocation" />
                                        </div>

                                        <label for="functionDescription" class="col-md-2 control-label">功能描述</label>
                                        <div class="col-md-4">
                                            <textarea name="functionDescription" rows="1" class="form-control" ng-model="vm.FunctionDescription" />
                                        </div>
                                    </div>
                                </fieldset>
                                <fieldset ng-hide="vm.EquipmentType!=='量测设备'">
                                    <legend>校验信息</legend>
                                    <div class="form-group">
                                        <label for="checkDate" class="col-md-2 control-label">校验日期</label>
                                        <div class="col-md-4">
                                            <input name="CheckDate" class="form-control" type="date" ng-model="vm.CheckDate" required />
                                            <div class="error-messages" ng-messages="formEquipment.checkDate.$error" ng-show="operate.showValidation">
                                                <small ng-message="required">校验日期不能为空</small>
                                            </div>
                                        </div>

                                        <label for="checkInterval" class="col-md-2 control-label">校验周期</label>
                                        <div class="col-md-4">
                                            <div class="input-group">
                                                <input name="checkInterval" type="number" class="form-control" ng-model="vm.CheckInterval" required />
                                                <div class="error-messages" ng-messages="formEquipment.checkInterval.$error" ng-show="operate.showValidation">
                                                    <small ng-message="required">校验间隔不能为空</small>
                                                </div>
                                                <div class="input-group-addon">
                                                    <label class="label label-primary">月</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="addMode" class="col-md-2 control-label">校验类别</label>
                                        <div class="col-md-4">
                                            <button type="button" class="btn btn-default" ng-model="vm.CheckType" data-html="1" data-multiple="0"
                                                    data-animation="am-flip-x" data-placeholder="内校"
                                                    bs-options="item.text as item.text for item in vmManager.checkTypes" bs-select>
                                                <span class="caret"></span>
                                            </button>
                                            <input name="checkType" class="form-control" ng-model="vm.CheckType" ng-show="false" required />
                                            <div class="error-messages" ng-messages="formEquipment.checkType.$error" ng-show="operate.showValidation">
                                                <small ng-message="required">校验类别不能为空</small>
                                            </div>
                                        </div>
                                    </div>
                                </fieldset>
                                <fieldset ng-hide="vm.AssetType==='低质易耗品'">
                                    <legend>保养信息</legend>
                                    <div class="form-group">
                                        <label for="maintenanceDate" class="col-md-2 control-label">保养日期</label>
                                        <div class="col-md-4">
                                            <input name="maintenanceDate" type="date" class="form-control" ng-model="vm.MaintenanceDate" required />
                                            <div class="error-messages" ng-messages="formEquipment.maintenanceDate.$error" ng-show="operate.showValidation">
                                                <small ng-message="required">保养日期不能为空</small>
                                            </div>
                                        </div>

                                        <label for="maintenanceInterval" class="col-md-2 control-label">保养周期</label>
                                        <div class="col-md-4">
                                            <div class="input-group">
                                                <input name="maintenanceInterval" type="number" class="form-control" ng-model="vm.MaintenanceInterval" required />
                                                <div class="error-messages" ng-messages="formEquipment.maintenanceInterval.$error" ng-show="operate.showValidation">
                                                    <small ng-message="required">保养周期不能为空</small>
                                                </div>
                                                <div class="input-group-addon">
                                                    <label class="label label-primary">月</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </fieldset>
                                <hr />
                                <div class="alert alert-info">
                                    <div class="row">
                                        <div class="col-md-2">
                                        </div>
                                        <div class="col-md-10">
                                            <button class="btn btn-primary" ng-click="operate.saveAll(formEquipment.$valid)"><i class="fa fa-save"></i>保存</button>
                                            <button class="btn btn-default" ng-click="operate.refresh()"><i class="fa fa-undo"></i>取消</button>
                                            <span yl-operatemsg-board></span>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <ul class="list-group">
                            <li class="list-group-item active">
                                <div class="row">
                                    <div class="col-md-4">
                                        <h4 class="list-title">
                                            <i class="fa fa-list"></i>
                                            <span>列表</span>
                                        </h4>
                                    </div>
                                    <div class="col-md-8">
                                        <div class="input-group">
                                            <input class="form-control" type="text" />
                                            <div class="input-group-addon">
                                                <i class="fa fa-search"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            <li class="list-group-item" ng-click="vmManager.selectEquipment(item)"
                                data-title="设备型号:{{item.EquipmentSpec}}" data-bs-tooltip
                                ng-repeat="item in vmManager.equipments track by $index">
                                编号：
                                <span class="label label-success" style="cursor:pointer">{{item.AssetNumber}}</span>
                                -----
                                名称：
                                <span>
                                    <i class="fa fa-envelope-o"></i>
                                    {{item.EquipmentName}}
                                </span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div bs-pane data-title="设备档案编辑" data-name="editTab">
                <div class="well">
                    <div class="row">
                        <div class="col-md-6">
                            <form class="form-inline" novalidate>
                                <div class="form-group">
                                    <label for="inputDate">录入日期</label>
                                    <input name="inputDate" type="date" class="form-control" ng-model="vmManager.inputDate" format-date required />
                                </div>
                                <span class="btn btn-primary" ng-click="vmManager.getAstDatas(3)"><i class="fa fa-search"></i>查询</span>
                            </form>
                        </div>
                        <div class="col-md-6">
                            <form class="form-inline" novalidate>
                                <div class="form-group">
                                    <label for="assetNum">财产编号</label>
                                    <input name="assetNum" type="text" class="form-control" ng-model="vmManager.assetNum" required />
                                </div>
                                <span class="btn btn-primary" ng-click="vmManager.getAstDatas(1)"><i class="fa fa-search"></i>查询</span>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="well" cg-busy="{promise:searchPromise}">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr class="info">
                                    <th>财产编号</th>
                                    <th>设备名称</th>
                                    <th>设备型号</th>
                                    <th>制造编号</th>
                                    <th>资产类别</th>
                                    <th>设备类别</th>
                                    <th>税务类别</th>
                                    <th>单位</th>
                                    <th>生产厂家</th>
                                    <th>购入日期</th>
                                    <th>保管人</th>
                                    <th>操作(<i class="fa fa-pencil-square-o"></i>)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="item in vmManager.editDatas track by $index">
                                    <td>{{item.AssetNumber}}</td>
                                    <td>{{item.EquipmentName}}</td>
                                    <td>{{item.EquipmentSpec}}</td>
                                    <td>{{item.ManufacturingNumber}}</td>
                                    <td>{{item.AssetType}}</td>
                                    <td>{{item.EquipmentType}}</td>
                                    <td>{{item.TaxType}}</td>
                                    <td>{{item.Unit}}</td>
                                    <td>{{item.Manufacturer}}</td>
                                    <td>{{item.DeliveryDate}}</td>
                                    <td>{{item.SafekeepUser}}</td>
                                    <td>
                                        <button class="btn btn-xs btn-primary" ng-click="operate.editItem(item)" title="修改">
                                            修改
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    <div class="panel-footer">
    </div>
</div>